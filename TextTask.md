# Тестовое задание

## Описание

Разработать систему для обработки заказов в онлайн-магазине. Система должна позволять создавать заказы, обновлять их статус, а также предоставлять информацию о текущем статусе заказа. Требования включают поддержку высокой нагрузки, обработку ошибок и возможность масштабирования.

Приложение должно быть построено с использованием Java 8-17, Spring Boot 3, PostgreSQL и Liquibase для миграций базы данных.

## Требования к функциональности

### 1. **POST api/v1/orders**
- **Описание**: Создание нового заказа.
- **Тело запроса**:

    ```json
    {
      "orderId": "UUID",
      "customerId": "UUID",
      "orderItems": [
        {
          "productId": "UUID",
          "quantity": 2,
          "price": 1000
        },
        ...
      ],
      "status": "PENDING"
    }
    ```

- **Логика**:
    - Создание нового заказа с переданными товарами и состоянием заказа `PENDING`.
    - В ответ возвращается заказ с уникальным `orderId`.
    - При создании заказа проверять, что товары в заказе существуют в базе данных.

### 2. **GET api/v1/orders/{orderId}**
- **Описание**: Получение информации о заказе по `orderId`.
- **Ответ**:

    ```json
    {
      "orderId": "UUID",
      "customerId": "UUID",
      "orderItems": [
        {
          "productId": "UUID",
          "quantity": 2,
          "price": 1000
        },
        ...
      ],
      "status": "PENDING"
    }
    ```

- **Логика**:
    - Возвращать информацию о заказе, включая товары и статус.
    - В случае отсутствия заказа возвращать ошибку 404.

### 3. **PUT api/v1/orders/{orderId}**
- **Описание**: Обновление статуса заказа.
- **Тело запроса**:

    ```json
    {
      "status": "PROCESSING" | "SHIPPED" | "DELIVERED" | "CANCELLED"
    }
    ```

- **Логика**:
    - Обновление статуса заказа.
    - Статус заказа может быть изменен только на следующую стадию (например, `PENDING` → `PROCESSING`).
    - Возвращать ошибку 400, если попытка изменить статус не по порядку.

### 4. **GET api/v1/orders**
- **Описание**: Получение списка заказов с фильтрацией по статусу.
- **Параметры запроса**:
    - `status`: фильтрация по статусу заказа.
- **Ответ**:

    ```json
    [
      {
        "orderId": "UUID",
        "customerId": "UUID",
        "status": "PENDING",
        "orderItems": [
          {
            "productId": "UUID",
            "quantity": 2,
            "price": 1000
          }
        ]
      }
    ]
    ```

### 5. **Ошибки**
- В случае неверных данных или недоступности заказа, ответы должны быть в формате:
    - **400 Bad Request**: если JSON невалидный или статус заказа недопустим.
    - **404 Not Found**: если заказ с указанным `orderId` не существует.
    - **400 Bad Request**: если обновление статуса заказа нарушает порядок (например, заказ в статусе `DELIVERED` не может быть снова сделан `PENDING`).

### 6. **Конкурентность**
- Приложение должно поддерживать до 1000 RPS на заказ.
- Использовать механизмы синхронизации на уровне базы данных для предотвращения гонок и обеспечения консистентности данных.
- Обработка транзакций должна быть атомарной, операции должны быть защищены от частичных изменений (например, с использованием `optimistic locking`).

### 7. **Конфигурируемость**
- Все параметры приложения (например, настройки базы данных, количество потоков, настройки контейнеров и т.д.) должны быть настроены через конфигурационные файлы, такие как `application.properties` или через переменные окружения, без необходимости пересборки контейнеров.

### 8. **Докеризация**
- Приложение и база данных должны работать в Docker контейнерах.
- Система должна быть поднята с помощью `docker-compose`.

## Технические требования

1. **Java**: 8-17.
2. **Spring Boot**: 3.x.
3. **База данных**: PostgreSQL с использованием Liquibase для миграций.
4. **Liquibase**: миграции для
